#[ZMui,XDMiDu,midu1,Z,Cpp,Di,H]=gas_physical(T(1,1),P(1,1)/1000,zf);
#[ md Z μ0 Cpm H_kg Di K_T K_V]=bwrs(P,T0,x)
#bwrs1(P,T0,x)=[md1]
#氢气放在组分的第一个
function bwrsH2(P, T0, x::Matrix{})
    A=[0.443690 1.284380 0.356306 0.544979 0.528629 0.484011 0.0705233 0.5040870 0.0307452 0.0732828 0.0064500]
    B=[0.115449 -0.920731 1.70871 -0.270896 0.349261 0.754130 -0.044448 1.32245 0.179433 0.463492 -0.022143]
    w=[0.0 0.013 0.101 0.1018 0.15 0.157 0.183 0.197 0.226 0.252 0.302 0.353 0.412 0.475 0.54 0.6 0.035 0.21 1.105 ]#偏心因子
    row=[15.579 10.05 8.0653 6.7566 5.5248 4.9994 3.8012 3.9213 3.2469 3.2149 2.7167 2.3467 2.0568 1.8421 1.6611 1.5154 11.099 10.638 10.526 ]#临界密度
    T=[32.98 190.69 283.05 305.38 365.04 369.89 408.13 425.18 460.37 469.49 507.28 540.28 568.58 594.57 617.54 639.99 126.15 304.09 373.39 ]#临界温度
    μ=[2.01588 16.042 28.05 30.068 42.08 44.094 58.12 58.12 72.146 72.0146 86.172 100.198 114.224 178.25 142.276 156.3 28.016 44.01 34.076 ]#各组分相对分子质量
    H_A = [28.672 135.84210 0 379.2766 0  385.4736 377.0006 382.4968 393.1319 403.4701 309.809 312.0396 303.7124 294.7414 275.4521 0 -2.17251 11.11374 -1.43705 ]
    H_B = [13.39616 2.39359  0  1.10899 0   0.72265  0.19545  0.4127  -0.1319  -0.0117  0.95923  0.7545  0.72467  0.7078  0.85137  0 1.06849  0.47911  0.99887  ]
    H_C1 = [29.60131 -22.18007 0  -1.88512 0   7.08716  25.23143  20.28601  35.41155  33.16498  -6.14724  2.61728  3.67845  4.38048  -2.063041  0   -1.34096  7.62195  -1.84315  ]
    H_C = [i*10^-4 for i in H_C1]
    H_D1 = [-39.80745 57.4022  0 39.6558  0  29.23895  1.95651  7.02953  -13.33225  -11.7051  61.42103  43.66359  41.42833  39.69342  55.21815  0  2.15569  -3.59392  5.57088  ]
    H_D = [i*10^-7 for i in H_D1]
    H_E1 = [266.1667 -372.79 0  -314.0209 0   -261.5071  -77.26149  -102.5871  25.14633  19.96476  -616.0952  -448.4511  -424.0198  -404.3158  -563.1732  0  -7.86319  8.47438  -31.77336  ]
    H_E = [i*10^-11 for i in H_E1]
    H_F1 = [-60.99862 85.49685  0  80.08189  0  70.00448  23.86087  28.83394  -1.29589  -0.86652  208.6819  148.421  137.3406  128.7595  188.8545  0 0.69851  -0.57752  6.36644  ]
    H_F = [i*10^-14 for i in H_F1]
    K=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
       0 0 0.01 0.01 0.021 0.023 0.0275 0.031 0.036 0.041 0.05 0.06 0.07 0.081 0.092 0.101 0.025 0.05 0.05;
       0 0 0 0 0.003 0.0031 0.004 0.0045 0.005 0.006 0.007 0.0085 0.01 0.012 0.013 0.015 0.07 0.048 0.045;#对齐
       0 0 0 0 0.003 0.0031 0.004 0.0045 0.005 0.006 0.007 0.0085 0.01 0.012 0.013 0.015 0.07 0.048 0.045;
       0 0 0 0 0 0 0.003 0.0035 0.004 0.0045 0.005 0.0065 0.008 0.01 0.011 0.013 0.1 0.045 0.04;
       0 0 0 0 0 0 0.003 0.0035 0.004 0.0045 0.005 0.0065 0.008 0.01 0.011 0.013 0.1 0.045 0.04;
       0 0 0 0 0 0 0 0 0.008 0.001 0.0015 0.0018 0.002 0.0025 0.003 0.003 0.11 0.05 0.036;
       0 0 0 0 0 0 0 0 0.008 0.001 0.0015 0.0018 0.002 0.0025 0.003 0.003 0.12 0.05 0.034;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.134 0.05 0.028;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.148 0.05 0.02;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.172 0.05 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0.05 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.228 0.05 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.264 0.05 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.204 0.05 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.322 0.05 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.035;
       0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;]
#-------------------------------------单一物质---------------------------------
#-------------------------------------先对A0,B0,C0,C,D0,E0,a,b,d,α,γ进行定义--------------------------
    B0=Array{Float64}(undef,1,length(x))
    A0=Array{Float64}(undef,1,length(x))
    c=Array{Float64}(undef,1,length(x))
    C0=Array{Float64}(undef,1,length(x))
    D0=Array{Float64}(undef,1,length(x))
    E0=Array{Float64}(undef,1,length(x))
    a=Array{Float64}(undef,1,length(x))
    b=Array{Float64}(undef,1,length(x))
    d=Array{Float64}(undef,1,length(x))
    α=Array{Float64}(undef,1,length(x))
    γ=Array{Float64}(undef,1,length(x))
    R=8.3143#j/kg/k
#----------------------------------------求单一物质公式--------------------------------------------
    for i in 1:length(x)
        B0[i]=(A[1]+B[1]*w[i])/row[i]
        A0[i]=(A[2]+B[2]*w[i])*R*T[i]/row[i]
        C0[i]=(A[3]+B[3]*w[i])*R*(T[i])^3/row[i]
        D0[i]=(A[9]+B[9]*w[i])*R*(T[i])^4/row[i]
        γ[i]=(A[4]+B[4]*w[i])/(row[i])^2
        b[i]=(A[5]+B[5]*w[i])/(row[i])^2
        a[i]=(A[6]+B[6]*w[i])*R*(T[i])/(row[i])^2
        c[i]=(A[8]+B[8]*w[i])*R*(T[i])^3/(row[i])^2
        d[i]=(A[10]+B[10]*w[i])*R*(T[i])^2/(row[i])^2
        α[i]=(A[7]+B[7]*w[i])/(row[i])^3
        E0[i]=(A[11]+B[11]*w[i]*exp(-3.8*w[i]))*R*(T[i]^5)/row[i]
end
#-------------------------------------------混合物的相关参数------------------------------------
     A0H=0
     B0H=0#变量位置
     C0H=0
     D0H=0
     E0H=0
    ah1=0
    bh1=0
    ch1=0
    dh1=0
    αh1=0
    γh1=0
     ah=0
     bh=0
     ch=0
     dh=0
     αh=0
     γh=0
    for i in 1:length(x)#对齐（快捷键）
        for j in 1:length(x)
            A0H+=x[i]*x[j]*((A0[i])^(0.5))*((A0[j])^(0.5))*(1-K[i,j])#xy
            C0H=x[i]*x[j]*((C0[i])^(0.5))*((C0[j])^(0.5))*(1-K[i,j])^3+C0H
            D0H=x[i]*x[j]*((D0[i])^(0.5))*((D0[j])^(0.5))*(1-K[i,j])^4+D0H
            E0H=x[i]*x[j]*((E0[i])^(0.5))*((E0[j])^(0.5))*(1-K[i,j])^5+E0H
        end
    end
    for i in 1:length(x)
        ah1+=x[i]*a[i]^(1/3)
        bh1=(x[i]*(b[i])^(1/3)+bh1)
        ch1=(x[i]*(c[i])^(1/3)+ch1)
        dh1=(x[i]*(d[i])^(1/3)+dh1)
        γh1=(x[i]*(γ[i])^(1/2)+γh1)
        αh1=(x[i]*(α[i])^(1/3)+αh1)
        B0H=x[i]*B0[i]+B0H
    end
    ah=ah1^3
    bh=bh1^3
    ch=ch1^3
    dh=dh1^3
    αh=αh1^3
    γh=γh1^2
 #-------------------------------------------求密度-------------------------------------------
    μ0=0
    for i in 1:length(x)
        μ0+=(x[i]*μ[i])
    end
     ROW=[]
    md=0
    push!(ROW,0)
    push!(ROW,P/(R*T0))
    for i in 1:100
        F1=ROW[i]*R*T0+(B0H*R*T0-A0H-C0H/(T0^2)+D0H/(T0^3)-E0H/(T0^4))*ROW[i]^2+(bh*R*T0-ah-dh/T0)*ROW[i]^3+αh*(ah+dh/T0)*(ROW[i])^6+(ch*ROW[i]^3/T0^2*(1+γh*(ROW[i])^2)*exp(-γh*(ROW[i])^2))-P
        F2=ROW[i+1]*R*T0+(B0H*R*T0-A0H-C0H/(T0^2)+D0H/(T0^3)-E0H/(T0^4))*(ROW[i+1])^2+(bh*R*T0-ah-dh/T0)*(ROW[i+1])^3+αh*(ah+dh/T0)*(ROW[i+1])^6+ch*((ROW[i+1])^3)/T0^2*(1+γh*(ROW[i+1])^2)*exp(-γh*(ROW[i+1]^2))-P
        push!(ROW,(ROW[i]*F2-ROW[i+1]*F1)/(F2-F1))
    if abs(ROW[i+2]-ROW[i+1])<=0.0001
        md=ROW[i+2]#这个密度为kmol/m^3
        break
        end
    end
#----------------------------------------------压缩因子的计算-----------------------------------------
    Z= 1 + (B0H-A0H/R/T0-C0H/R/T0^3 + D0H/R/T0^4 - E0H/R/T0^5)*md+ (bh-ah/R/T0-dh/R/T0^2)*md^2+(αh/R/T0)*(ah+dh/T0)*md^5+(ch*md^2/R/T0^3)*(1 +γh*md^2)*exp(-γh*md^2)
#---------------------------------------------晗的计算--------------------------------
    HA=0
    HB=0
    HC=0
    HD=0
    HE=0
    HF=0
    H_0=0
    for i in 1:length(x)#（设置变量）
        HA = (x[i]*μ[i]*H_A[i])/μ0+HA
        HB = (x[i]*μ[i]*H_B[i])/μ0+HB
        HC = (x[i]*μ[i]*H_C[i])/μ0+HC
        HD = (x[i]*μ[i]*H_D[i])/μ0+HD
        HE = (x[i]*μ[i]*H_E[i])/μ0+HE
        HF = (x[i]*μ[i]*H_F[i])/μ0+HF
    end
    H_0 = HA + HB * T0 + HC * T0^2 + HD * T0^3 + HE * T0^4 + HF * T0^5#单位kj/kg
#H单位为kj/kmol
    H = 1000*(H_0*μ0+(B0H*R*T0-2*A0H-4*C0H/T0^2+5*D0H/T0^3-6*E0H/T0^4)*md+0.5*(2*bh*R*T0-3*ah-4*dh/T0)*md^2+0.2*αh*(6*ah+7*dh/T0)*md^5+ch/(γh*T0^2)*(3-(3+(γh*md^2)/2-γh^2*md^4)*exp(-γh*md^2)))
#单位为kj/kg
    H_kg=H/μ0
#------------------------------------------ 计算低压比热（cp、cv)-------------------------
    Cp0=0
    Cp=Array{Float64}(undef,1,length(x))
    for i in 1:length(x)
        Cp[i]=H_B[i]+2*H_C[i]*T0+3*H_D[i]*T0^2+4*H_E[i]*T0^3+5*H_F[i]*T0^4
        Cp0+=Cp[i]*x[i]
    end
     Cv0=Cp0*μ0-R#单位kj/kmol.K
# ---------------------------------高压定容比热、高压定压比热--------------------------
    P_T = md*R+(B0H*R+2*C0H/T0^3-3*D0H/T0^4+4*E0H/T0^5)*md^2+(bh*R+dh/T0^2)*md^3-(αh*dh*md^6)/T0^2-2*ch*md^3/T0^3*(1+γh*md^2)*exp(-γh*md^2)
    P_M = R*T0+2*(B0H*R*T0-A0H-C0H/T0^2+D0H/T0^3-E0H/T0^4)*md+3*(bh*R*T0-ah-dh/T0)*md^2+6*αh*(ah+dh/T0)*md^5+(3*ch/T0^2*md^2*(1+γh*md^2-(2*γh^2*md^4)/3)*exp(-γh*md^2))
#--------------------单位kj/kmol.k
    Cvm =Cv0+((6*C0H/T0^3-12*D0H/T0^4+20*E0H/T0^5)*md+(dh*md^2)/T0^2-(2*αh*dh*(md^5))/(5*(T0^2))+(3*ch*((γh*md^2+2)exp(-γh*md^2)-2))/(γh*T0^3))*μ0
    # Cv = Cv0 + (6 * C01 / T^ 3 - 12 * D01 / T^ 4 + 20 * E01 / T^ 5) * midu1 + dd1 * midu1 ^ 2 / T^ 2 - 0.4 * arr1 * dd1 * midu1^ 5 / T^ 2 + 3 * cc1 * ((rr1 * midu1^ 2 + 2) * exp(-rr1 * midu1^ 2) - 2)/ (rr1 * T^ 3)

    Cpm=13.19+0.092*T0-6.24*10^(-5)*T0^2+1.915*10^11*μ0*((P/1000)^1.124)/(T0^5.08)
    # Cpm=Cvm+(T0/md^2)*P_T^2/P_M
#-------------------------------焦耳-汤姆逊系数(节流效应系数）k/mpa----------------------------------
    Di = (1000/Cpm)*((T0/md^2)*P_T/P_M-(1/md))
#------------------------------- 温度绝热指数 体积绝热指数------------------------------
    K_T = 1/(1-(P*P_T)/(md^2*Cpm*P_M))
    K_V = (md*Cpm*P_M)/(P*Cvm)
#设置函数调用
#return md1#,Z,μ0,Cpm,H_kg,Di,K_T,K_V,P,T0
return md,Z,μ0,Cpm,H_kg,Di,K_T,K_V
end
    #  s=bwrsH2(101.325, 293, [0 0.975 0 0.002 0 0.002 0 0 0 0 0 0 0 0 0 0 0.016 0.005 0])
#  println(s[1]*s[3])


